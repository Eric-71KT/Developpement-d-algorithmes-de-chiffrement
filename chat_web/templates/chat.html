<!DOCTYPE html>
<html>
<head>
    <title>Chat Web - Flask</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <div id="chat-container">
        <h2>Chat Room</h2>
        <input id="username" placeholder="Nom d'utilisateur">
        <input id="room" placeholder="Nom de la salle (ex: room1)">
        <button onclick="joinRoom()">Rejoindre</button>
        <button onclick="leaveRoom()">Quitter</button>
        <div id="messages" class="chat-box"></div>
        <input id="message" placeholder="Tapez un message...">
        <button onclick="sendMessage()">Envoyer</button>
    </div>

    <script>
        const socket = io.connect('http://' + document.domain + ':' + location.port);

        socket.on('message', function(data) {
            const msgBox = document.getElementById('messages');
            msgBox.innerHTML += `<p><strong>${data.user}:</strong> ${data.msg}</p>`;
            msgBox.scrollTop = msgBox.scrollHeight;
        });

        function joinRoom() {
            const username = document.getElementById('username').value;
            const room = document.getElementById('room').value;
            if (username && room) {
                socket.emit('join', {username, room});
            } else {
                alert('Veuillez entrer un nom et une salle');
            }
        }

        function leaveRoom() {
            const room = document.getElementById('room').value;
            if (room) {
                socket.emit('leave', {room});
            }
        }

        function sendMessage() {
            const message = document.getElementById('message').value;
            const room = document.getElementById('room').value;
            if (message && room) {
                socket.emit('message', {msg: message, room: room});
                document.getElementById('message').value = '';
            } else {
                alert('Entrez un message et une salle');
            }
        }
    </script>
</body>
</html>